{"ast":null,"code":"import _objectSpread from\"C:/workspace/ws-sts/ulasoftware-metas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _process$env$REACT_AP,_process$env$REACT_AP2,_process$env$REACT_AP3;import axios from\"axios\";import qs from\"qs\";import history from'./history';import{getAuthData}from'./storage';//const secureUrl = `https://${'89.116.225.116'}:8089`;\nexport var BASE_URL=(_process$env$REACT_AP=process.env.REACT_APP_BACKEND_URL)!==null&&_process$env$REACT_AP!==void 0?_process$env$REACT_AP:'https://ulasoftware-metas-bee63543f5ed.herokuapp.com';var CLIENT_ID=(_process$env$REACT_AP2=process.env.REACT_APP_BACKEND_URL)!==null&&_process$env$REACT_AP2!==void 0?_process$env$REACT_AP2:'farol';var CLIENT_SECRET=(_process$env$REACT_AP3=process.env.REACT_APP_BACKEND_URL)!==null&&_process$env$REACT_AP3!==void 0?_process$env$REACT_AP3:'123456';export var requestBackendLogin=function requestBackendLogin(loginData){var headers={'Content-Type':'application/x-www-form-urlencoded',Authorization:'Basic '+window.btoa(CLIENT_ID+':'+CLIENT_SECRET)};var data=qs.stringify(_objectSpread(_objectSpread({},loginData),{},{grant_type:'password'}));return axios({method:'POST',baseURL:BASE_URL,url:'/oauth/token',data:data,headers:headers});};export var requestBackend=function requestBackend(config){var headers=config.withCredentials?_objectSpread(_objectSpread({},config.headers),{},{Authorization:\"Bearer \"+getAuthData().access_token}):config.headers;return axios(_objectSpread(_objectSpread({},config),{},{baseURL:BASE_URL,headers:headers}));};// Add a request interceptor\naxios.interceptors.response.use(function(response){return response;},function(error){if(error.response.status===401/*  || error.response.status === 403  */){history.push('/auth/login');}return Promise.reject(error);});","map":{"version":3,"sources":["C:/workspace/ws-sts/ulasoftware-metas/frontend/src/utils/request.ts"],"names":["axios","qs","history","getAuthData","BASE_URL","process","env","REACT_APP_BACKEND_URL","CLIENT_ID","CLIENT_SECRET","requestBackendLogin","loginData","headers","Authorization","window","btoa","data","stringify","grant_type","method","baseURL","url","requestBackend","config","withCredentials","access_token","interceptors","response","use","error","status","push","Promise","reject"],"mappings":"4OAAA,MAAOA,CAAAA,KAAP,KAA0C,OAA1C,CACA,MAAOC,CAAAA,EAAP,KAAe,IAAf,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,OAASC,WAAT,KAA2B,WAA3B,CAEA;AAEA,MAAO,IAAMC,CAAAA,QAAQ,wBAAGC,OAAO,CAACC,GAAR,CAAYC,qBAAf,+DAAwC,sDAAtD,CAEP,GAAMC,CAAAA,SAAS,yBAAGH,OAAO,CAACC,GAAR,CAAYC,qBAAf,iEAAwC,OAAvD,CACA,GAAME,CAAAA,aAAa,yBAAGJ,OAAO,CAACC,GAAR,CAAYC,qBAAf,iEAAwC,QAA3D,CAMA,MAAO,IAAMG,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACC,SAAD,CAA0B,CACzD,GAAMC,CAAAA,OAAO,CAAG,CACZ,eAAgB,mCADJ,CAEZC,aAAa,CAAE,SAAWC,MAAM,CAACC,IAAP,CAAYP,SAAS,CAAG,GAAZ,CAAkBC,aAA9B,CAFd,CAAhB,CAKA,GAAMO,CAAAA,IAAI,CAAGf,EAAE,CAACgB,SAAH,gCACNN,SADM,MAETO,UAAU,CAAE,UAFH,GAAb,CAKA,MAAOlB,CAAAA,KAAK,CAAC,CAAEmB,MAAM,CAAE,MAAV,CAAkBC,OAAO,CAAEhB,QAA3B,CAAqCiB,GAAG,CAAE,cAA1C,CAA0DL,IAAI,CAAJA,IAA1D,CAAgEJ,OAAO,CAAPA,OAAhE,CAAD,CAAZ,CACH,CAZM,CAcP,MAAO,IAAMU,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,MAAD,CAAgC,CAC1D,GAAMX,CAAAA,OAAO,CAAGW,MAAM,CAACC,eAAP,gCAELD,MAAM,CAACX,OAFF,MAGRC,aAAa,CAAE,UAAYV,WAAW,GAAGsB,YAHjC,GAKVF,MAAM,CAACX,OALb,CAOA,MAAOZ,CAAAA,KAAK,gCAAMuB,MAAN,MAAcH,OAAO,CAAEhB,QAAvB,CAAiCQ,OAAO,CAAPA,OAAjC,GAAZ,CACH,CATM,CAWP;AACAZ,KAAK,CAAC0B,YAAN,CAAmBC,QAAnB,CAA4BC,GAA5B,CAAgC,SAAUD,QAAV,CAAoB,CAChD,MAAOA,CAAAA,QAAP,CACH,CAFD,CAEG,SAAUE,KAAV,CAAiB,CAChB,GAAIA,KAAK,CAACF,QAAN,CAAeG,MAAf,GAA0B,GAAI,wCAAlC,CAA4E,CACxE5B,OAAO,CAAC6B,IAAR,CAAa,aAAb,EACH,CACD,MAAOC,CAAAA,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP,CACH,CAPD","sourcesContent":["import axios, { AxiosRequestConfig } from \"axios\";\r\nimport qs from \"qs\";\r\nimport history from './history';\r\nimport { getAuthData} from './storage'\r\n\r\n//const secureUrl = `https://${'89.116.225.116'}:8089`;\r\n\r\nexport const BASE_URL = process.env.REACT_APP_BACKEND_URL ?? 'https://ulasoftware-metas-bee63543f5ed.herokuapp.com';\r\n\r\nconst CLIENT_ID = process.env.REACT_APP_BACKEND_URL ?? 'farol';\r\nconst CLIENT_SECRET = process.env.REACT_APP_BACKEND_URL ?? '123456';\r\n\r\ntype LoginData = {\r\n    username: string;\r\n    password: string;\r\n}\r\nexport const requestBackendLogin = (loginData: LoginData) => {\r\n    const headers = {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        Authorization: 'Basic ' + window.btoa(CLIENT_ID + ':' + CLIENT_SECRET),\r\n    };\r\n\r\n    const data = qs.stringify({\r\n        ...loginData,\r\n        grant_type: 'password',\r\n    });\r\n\r\n    return axios({ method: 'POST', baseURL: BASE_URL, url: '/oauth/token', data, headers, })\r\n}\r\n\r\nexport const requestBackend = (config: AxiosRequestConfig) => {\r\n    const headers = config.withCredentials\r\n        ? {\r\n            ...config.headers,\r\n            Authorization: \"Bearer \" + getAuthData().access_token,\r\n        }\r\n        : config.headers;\r\n\r\n    return axios({ ...config, baseURL: BASE_URL, headers });\r\n}\r\n\r\n// Add a request interceptor\r\naxios.interceptors.response.use(function (response) {\r\n    return response;\r\n}, function (error) {\r\n    if (error.response.status === 401 /*  || error.response.status === 403  */) {\r\n        history.push('/auth/login');\r\n    }\r\n    return Promise.reject(error);\r\n});"]},"metadata":{},"sourceType":"module"}